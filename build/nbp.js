!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["nist-bp"]=e():t["nist-bp"]=e()}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(1),i=new o,s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var e=new o;this.debug={bloom:e,version:1}}var e,n,s;return e=t,(n=[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mostcommon_10000",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"collections/",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.split("_"),o=r[r.length-1];if("number"==typeof o)return console.error("[NBP] Provided wordlist file must match the format [list description]_[list length]"),console.error("i.e. mostcommon_10000"),!1;if("/"!==e.slice(-1)&&(e+="/"),"undefined"!=typeof localStorage&&void 0!==localStorage["NBP_".concat(t)]&&n)i.init(localStorage["NBP_".concat(t)],o);else{var s=new XMLHttpRequest,a="";s.onreadystatechange=function(){s.readyState===XMLHttpRequest.DONE&&(200===s.status?(a=s.responseText,n&&(localStorage["NBP_".concat(t)]=a),i.init(a,o),initState=!0):(console.error("[NBP] Error retrieving bloom contents. Error code: ".concat(s.status)),console.error("[NBP] Ensure that the word list is located at ".concat(e).concat(t)),console.error("[NBP] Additionally, file must match the format [list description]_[list length]")))},s.open("GET","".concat(e).concat(t),!0),s.send(null)}}},{key:"isCommonPassword",value:function(t){return""!=t&&(i.checkEntry(t)||i.checkEntry(t.toLowerCase()))}},{key:"testInit",value:function(t,e){i.init(t,e)}}])&&r(e.prototype,n),s&&r(e,s),t}();t.exports=s},function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(2),i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initalized=!1,this.hashRounds=null,this.bitArray=null,this.bitArrayLength=null,this.initState=!1,this.hashes={djb2:function(t,e){for(var n=5381,r=t.length,o=0;o<r;o++)n=33*n^t.charCodeAt(o);return(n>>>0)%e},sdbm:function(t,e){for(var n=0,r=t.length,o=0;o<r;o++)n=t.charCodeAt(o)+(n<<6)+(n<<16)-n;return(n>>>0)%e},getIndices:function(t,e,n,r){var o=[];o.push(r.djb2(t,e)),o.push(r.sdbm(t,e));for(var i=2;i<=n;i++){var s=(o[0]+i*o[1]+(2^i))%e;o.push(s)}return o}}}var e,n,i;return e=t,(n=[{key:"init",value:function(t,e){var n=o.decompressFromUTF16(t).split(",");this.bitArrayLength=8*n.length,this.hashRounds=Math.round(Math.log(2)*this.bitArrayLength/e),this.bitArray=new Uint8Array(n),this.initalized=!0}},{key:"checkEntry",value:function(t){if(!this.initalized)throw new Error("[NBP] Bloom filter has not been initalized, cannot run.");for(var e=this.hashes.getIndices(t,this.bitArrayLength,this.hashRounds,this.hashes),n=e.length-1;n>=0;n--){var r=e[n]%8,o=(e[n]-r)/8;if(0!=r&&0==(this.bitArray[o]&128>>r-1))return!1;if(0==r&&0==(1&this.bitArray[o]))return!1}return!0}}])&&r(e.prototype,n),i&&r(e,i),t}();t.exports=i},function(t,e,n){var r,o=function(){var t=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function o(t,e){if(!r[t]){r[t]={};for(var n=0;n<t.length;n++)r[t][t.charAt(n)]=n}return r[t][e]}var i={compressToBase64:function(t){if(null==t)return"";var n=i._compress(t,6,function(t){return e.charAt(t)});switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:i._decompress(t.length,32,function(n){return o(e,t.charAt(n))})},compressToUTF16:function(e){return null==e?"":i._compress(e,15,function(e){return t(e+32)})+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:i._decompress(t.length,16384,function(e){return t.charCodeAt(e)-32})},compressToUint8Array:function(t){for(var e=i.compress(t),n=new Uint8Array(2*e.length),r=0,o=e.length;r<o;r++){var s=e.charCodeAt(r);n[2*r]=s>>>8,n[2*r+1]=s%256}return n},decompressFromUint8Array:function(e){if(null==e)return i.decompress(e);for(var n=new Array(e.length/2),r=0,o=n.length;r<o;r++)n[r]=256*e[2*r]+e[2*r+1];var s=[];return n.forEach(function(e){s.push(t(e))}),i.decompress(s.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":i._compress(t,6,function(t){return n.charAt(t)})},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),i._decompress(t.length,32,function(e){return o(n,t.charAt(e))}))},compress:function(e){return i._compress(e,16,function(e){return t(e)})},_compress:function(t,e,n){if(null==t)return"";var r,o,i,s={},a={},c="",u="",l="",f=2,p=3,h=2,d=[],v=0,m=0;for(i=0;i<t.length;i+=1)if(c=t.charAt(i),Object.prototype.hasOwnProperty.call(s,c)||(s[c]=p++,a[c]=!0),u=l+c,Object.prototype.hasOwnProperty.call(s,u))l=u;else{if(Object.prototype.hasOwnProperty.call(a,l)){if(l.charCodeAt(0)<256){for(r=0;r<h;r++)v<<=1,m==e-1?(m=0,d.push(n(v)),v=0):m++;for(o=l.charCodeAt(0),r=0;r<8;r++)v=v<<1|1&o,m==e-1?(m=0,d.push(n(v)),v=0):m++,o>>=1}else{for(o=1,r=0;r<h;r++)v=v<<1|o,m==e-1?(m=0,d.push(n(v)),v=0):m++,o=0;for(o=l.charCodeAt(0),r=0;r<16;r++)v=v<<1|1&o,m==e-1?(m=0,d.push(n(v)),v=0):m++,o>>=1}0==--f&&(f=Math.pow(2,h),h++),delete a[l]}else for(o=s[l],r=0;r<h;r++)v=v<<1|1&o,m==e-1?(m=0,d.push(n(v)),v=0):m++,o>>=1;0==--f&&(f=Math.pow(2,h),h++),s[u]=p++,l=String(c)}if(""!==l){if(Object.prototype.hasOwnProperty.call(a,l)){if(l.charCodeAt(0)<256){for(r=0;r<h;r++)v<<=1,m==e-1?(m=0,d.push(n(v)),v=0):m++;for(o=l.charCodeAt(0),r=0;r<8;r++)v=v<<1|1&o,m==e-1?(m=0,d.push(n(v)),v=0):m++,o>>=1}else{for(o=1,r=0;r<h;r++)v=v<<1|o,m==e-1?(m=0,d.push(n(v)),v=0):m++,o=0;for(o=l.charCodeAt(0),r=0;r<16;r++)v=v<<1|1&o,m==e-1?(m=0,d.push(n(v)),v=0):m++,o>>=1}0==--f&&(f=Math.pow(2,h),h++),delete a[l]}else for(o=s[l],r=0;r<h;r++)v=v<<1|1&o,m==e-1?(m=0,d.push(n(v)),v=0):m++,o>>=1;0==--f&&(f=Math.pow(2,h),h++)}for(o=2,r=0;r<h;r++)v=v<<1|1&o,m==e-1?(m=0,d.push(n(v)),v=0):m++,o>>=1;for(;;){if(v<<=1,m==e-1){d.push(n(v));break}m++}return d.join("")},decompress:function(t){return null==t?"":""==t?null:i._decompress(t.length,32768,function(e){return t.charCodeAt(e)})},_decompress:function(e,n,r){var o,i,s,a,c,u,l,f=[],p=4,h=4,d=3,v="",m=[],y={val:r(0),position:n,index:1};for(o=0;o<3;o+=1)f[o]=o;for(s=0,c=Math.pow(2,2),u=1;u!=c;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=r(y.index++)),s|=(a>0?1:0)*u,u<<=1;switch(s){case 0:for(s=0,c=Math.pow(2,8),u=1;u!=c;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=r(y.index++)),s|=(a>0?1:0)*u,u<<=1;l=t(s);break;case 1:for(s=0,c=Math.pow(2,16),u=1;u!=c;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=r(y.index++)),s|=(a>0?1:0)*u,u<<=1;l=t(s);break;case 2:return""}for(f[3]=l,i=l,m.push(l);;){if(y.index>e)return"";for(s=0,c=Math.pow(2,d),u=1;u!=c;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=r(y.index++)),s|=(a>0?1:0)*u,u<<=1;switch(l=s){case 0:for(s=0,c=Math.pow(2,8),u=1;u!=c;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=r(y.index++)),s|=(a>0?1:0)*u,u<<=1;f[h++]=t(s),l=h-1,p--;break;case 1:for(s=0,c=Math.pow(2,16),u=1;u!=c;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=r(y.index++)),s|=(a>0?1:0)*u,u<<=1;f[h++]=t(s),l=h-1,p--;break;case 2:return m.join("")}if(0==p&&(p=Math.pow(2,d),d++),f[l])v=f[l];else{if(l!==h)return null;v=i+i.charAt(0)}m.push(v),f[h++]=i+v.charAt(0),i=v,0==--p&&(p=Math.pow(2,d),d++)}}};return i}();void 0===(r=function(){return o}.call(e,n,e,t))||(t.exports=r)}])});